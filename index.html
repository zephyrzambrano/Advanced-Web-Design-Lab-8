<!doctype html>
<html>
	<head>
		<title>Lab 8</title>
	</head>
    
    <canvas id="canvas" width="1260" height="630">
        Upgrade your browser to see the HTML5 Canvas!
    </canvas>
    
	<body>
		<style>
            #canvas {
                width: 100%;
            }
            
            #timestamp {
                color: red;
            }
            
            #message {
                color: red;
            }
            
            #latitude {
                color: red;
            }
            
            #longitude {
                color: red;
            }
            
		</style>
		
		<!--<div id="info"></div>
		<div id="timestamp"></div>
		<div id="message"></div>
        <div id="latitude"></div>
        <div id="longitude"></div>-->
		
		<script>
            //map image
            //https://images.pexels.com/photos/87652/earth-map-summer-july-87652.jpeg?cs=srgb&dl=earth-geography-map-87652.jpg&fm=jpg
            
            var canvas=document.getElementById("canvas");
            c=canvas.getContext("2d");
            
            
            //draw image onto canvas source
            //https://stackoverflow.com/questions/3868259/importing-image-on-canvas-html5
			var img=new Image();
			img.onload = function() {
				var ca=document.getElementById('canvas').getContext('2d');
				ca.drawImage(img, 0, 0);
			}
            img.src="worldmap.jpeg";
			
            
			window.setInterval(refresh, 1000);
			var apiBase="http://api.open-notify.org/iss-now.json";
			var data;
            
            var time;
			
			//var info=document.getElementById("info");
            var timestamp=document.getElementById("timestamp");
            var message=document.getElementById("message");
            var latitude=document.getElementById("latitude");
            var longitude=document.getElementById("longitude");
            
            //Set up xhr
            var xhr = new XMLHttpRequest();
            
            //Set the button listener
            //button.addEventListener("click", refresh);
            
            function refresh() {
                //Tell it what to do when it's loaded
                xhr.addEventListener("load",loadData);
                //Tell it the file to load
                xhr.open("GET", apiBase);
                //GO!
                xhr.send();
            }
			
			//parse and display data
			function loadData() {
			
			
				data=JSON.parse(xhr.responseText);
				
				//all the data in one div
				//info.innerHTML = data.timestamp.getTime() + " " + data.message + 
				//" " + data.iss_position.latitude + " " + data.iss_position.longitude;
                
				//data in separate divs
                
                /*timestamp.innerHTML=data.timestamp;
				message.innerHTML=data.message;
				latitude.innerHTML=data.iss_position.latitude;
				longitude.innerHTML=data.iss_position.longitude;*/
                
                latitude=data.iss_position.latitude;
				longitude=data.iss_position.longitude;
                
                console.log("Loaded!");
				
				//data.timestamp
				//data.message-box
				//data.iss_position.latitude
				//data.iss_position.longitude
			}
			
		</script>
	</body>
</html>